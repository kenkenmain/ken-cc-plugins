# Phase 1.1: Brainstorm [PHASE 1.1]

## Subagent Config

- **Type:** dispatch (Explore + general-purpose, parallel agents)
- **Input:** task description (from `state.json` `.task`)
- **Output:** `.agents/tmp/kenken/phases/1.1-brainstorm.md`

## Instructions

Understand the problem and design a production-ready solution. This phase dispatches parallel research agents before synthesizing findings into a brainstorm document.

### Process

1. Read existing code to understand context
2. Dispatch parallel Explore agents to research:
   - Existing patterns in the codebase
   - Requirements and constraints
   - Edge cases and failure modes
   - Security considerations
   - Observability patterns (logging, monitoring)
3. Aggregate agent findings
4. Determine 2-3 approaches with honest trade-offs

### What Every Approach Must Address

1. **Core functionality** — How it solves the problem
2. **Error handling** — What happens when every possible thing fails. Not "add later." Now.
3. **Edge cases** — Empty, null, max, concurrent, malicious inputs
4. **Security** — Auth, authz, validation, secrets management
5. **Observability** — Structured logging, monitoring hooks, anomaly detection
6. **Maintainability** — Can the next engineer understand and safely modify this?

### Red Flags

If any of these appear in an approach, flag it:

- "We can add error handling later" — Later never comes. The unhandled error does.
- "This edge case is unlikely" — Unlikely things happen every day at scale.
- "Security can be a follow-up" — Attackers don't wait for follow-ups.
- "Happy path should work" — Happy path is maybe 20% of production.

### Parallel Agent Dispatch

Dispatch 2-4 Explore agents depending on task complexity:

| Agent | Purpose | Focus |
| ----- | ------- | ----- |
| Pattern Scout | Find existing patterns | How does the codebase handle similar problems? |
| Constraint Mapper | Identify boundaries | System boundaries, untrusted input entry points |
| Failure Analyst | Map failure modes | What happens when each component fails? |
| Security Auditor | Security surface | Auth, injection, secrets, attack vectors |

Aggregate results before synthesizing approaches.

## Output Format

Write to `.agents/tmp/kenken/phases/1.1-brainstorm.md`:

```
# Brainstorm Results

## Problem Understanding
What's success? What's failure? Be specific about consequences if this goes wrong.

## Research Findings
Patterns. Conventions. Constraints. Existing failure modes.

## Approach 1: {name}
Summary: One sentence
How it works: Technical detail
Failure modes: What can go wrong. How.
Safety measures: How this design prevents failures
Pros: Advantages
Cons: Disadvantages — every design has them
Residual risk: What could still go wrong

## Approach 2: {name}
(Same structure — including explicit failure modes)

## Approach 3: {name} (if needed)
(Same structure)

## Recommendation
Which one. Why. What risks are you accepting. Worst case if wrong about those risks.

## Implementation Areas
List of distinct areas to plan in the next phase.

## Open Questions
What needs clarification. What assumptions could be wrong. What could change everything.
```

Be honest about failure modes. Every design can fail. Pretending yours can't doesn't make it safer — it makes the failure more catastrophic because you didn't prepare.
